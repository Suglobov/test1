## Установи бложик
Нужен установленый **git**  
Нужна база данных **mySql**  
Нужен **php-7.2**  
Нужен веб сервер **apache**
Все вместе можно установить в пакете **xampp**
```
https://www.apachefriends.org/ru/download.html
```

* В папке с проектом надо выполнить, для копирования проекта в папку
    ```
    git clone https://github.com/Suglobov/test1.git
    ```
* Выполнить клонирования конфигурации подключения к базе данных
    ```
    cp ./dbConnect/.define.php.example ./dbConnect/.define.php -i
    ```
    затем в файле **.define.php** поменять значения констант
    * DB_HOST - хост подключения к базе данных
    * DB_NAME - название базы данны. Получите ее после создания базы данных
    * DB_USER - пользователь для подключения к базе данных
    * DB_PASS - пароль для подключения
    * DB_PORT - порт mySql, по-которому происходит подключение
    
* Надо создать базу данных в mySql.  
    Название ее надо вписать в константу **DB_NAME **в файле **.define.php**.

* Надо импортировать в базу данных дамп из файла  
    **/tmp/blog.sql**
    
    
    





## Описание кода
### chunk
в этой папко содержатся html шаблоны.  
В некоторых из них есть значения в {{значение}},  
который используется для подставления значений из скрипта

 
### dbConnect
В папке файлы, нужные для подключения к базе данных
  
* dbConnect.php
Используя константы из файла **.define.php**  
производит подключение к базе данных и возвращает **$pdo**
(используется PDO)

* .define.php
В этом файле находится объявление констант,  
нужных для подключения к базе данных

* .define.php.example
В этом файле пример файла **.define.php**  
В начале развертывания происходит создание из этого файла **.define.php**,  
в новом файле надо поменять значения констант для корректного подключения к базе данных

* copy_example_to_define.sh
Этот файл в OS Linux при запуске попытается создать файл **.define.php**  
копированием из **.define.php.example**, если файл уже существует, выведет предупреждение


### snippet
В этой папке лежат файлы **php**, которые используются в коде доступных для пользователя страниц

* helper.php
Содержит набор функций нужные для вывода шаблонов, для проверки пользователя и документа

* testAccess.php
Этот файл подключается для проверки прав,  
так же для проверки "выхода" из авторизации

* testRequest.php
Этот файл подключается, для того, чтоб делать проверку данных для записи в базу данных,  
а так же саму запись в базу данных. Это делает функция **writeToDb**.
Так же в процессе записи происходит сохранение файла картинки на диск после проверок.
Если были ошибки, то функция возвращает массив ошибок.

* content.php
Выводит информацию из таблицы **content**, используется для вывода шаблон **chunk/content.html**

* views.php
Выводит топ просмотров за неделю из таблицы **content**, используется для вывода шаблон **chunk/content.html**


### tmp
Тут лежат картинки для тестового добавления в новость, и другие временные файлы


### www
Это папка доступная пользователю сайта для просмотра.

* папка image
Содержит сохраненные для новости картинки.

* папка js
там js файл. Но он пустой пока что пустой, все из него перенес в php

* adminPanel.php
Это страница с панелью администратора.  
Тут контент с ссылками для редактирования и ссылка-кнопка на страницу создания новой новости

* index.php
Главная страница сайта. На ней контент, топ новостей за неделю. Ссылки на страницу для просмотра отдельной новости.

* detail.php
Страница для просмотра отдельной новости.  
Если ее просматривает не администратор, то происходит фиксация просмотра,  
для вывода новости в топе новостей на главной

* edit.php
На этой странице происходит создание и редактирование новости.  
Доступ только для администратора

* login.php
Это страница авторизации. Знаешь пароль - повелитель новостей!

## известные проблемы
### при сохранение изменений в gitHub
картинки которые копируются от пользователя имеют ограниченные права.  
Поэтому перед сохранением их в репозиторий можно использовать скрипт,  
который решает эту проблему давай все права.  
**grant777ImageFolder.sh** требует root пароль
